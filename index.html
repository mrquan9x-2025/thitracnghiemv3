<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªåC TO√ÅN TH·∫¶Y QU√ÇN</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        
        /* BRANDING */
        .brand-title { text-align: center; color: #007bff; text-transform: uppercase; margin-bottom: 5px; font-size: 2em; letter-spacing: 1px; }
        .brand-subtitle { text-align: center; color: #666; font-style: italic; font-size: 1.1em; margin-top: 0; margin-bottom: 30px; }

        h2 { text-align: center; color: #333; margin-top: 30px;}
        .section-header { background: #e9ecef; padding: 10px; margin: 20px 0 10px; font-weight: bold; border-radius: 5px; color: #495057; text-transform: uppercase; font-size: 0.9em; }
        
        /* UI Elements */
        .btn { background: #007bff; color: white; border: none; padding: 12px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; width: 100%; margin-top: 15px; font-weight: bold; transition: 0.2s; }
        .btn:hover { background: #0056b3; }
        .btn-outline { background: transparent; border: 1px solid #007bff; color: #007bff; margin-top: 15px; }
        
        input, textarea, select { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; font-size: 14px; }
        
        /* Grid Layout Admin */
        .config-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 5px; }
        .config-group { background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #eee; margin-bottom: 15px; }
        .config-label { font-size: 0.9em; font-weight: bold; color: #333; margin-bottom: 5px; display: block; }

        /* Exam Layout */
        .question-box { background: #fff; padding: 20px; margin-bottom: 15px; border: 1px solid #e1e4e8; border-radius: 8px; }
        .q-title { font-weight: bold; margin-bottom: 10px; display: block; color: #2c3e50; }
        
        /* --- S·ª¨A UI MOBILE --- */
        .options-grid { 
            display: flex; 
            gap: 5px; /* Gi·∫£m kho·∫£ng c√°ch ƒë·ªÉ kh√¥ng b·ªã r·ªõt d√≤ng */
            justify-content: space-between; /* CƒÉn ƒë·ªÅu 2 b√™n */
            margin-top: 10px; 
            flex-wrap: nowrap; /* Kh√¥ng cho ph√©p xu·ªëng d√≤ng */
        }
        .option-item { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            cursor: pointer; 
            flex: 1; /* Chia ƒë·ªÅu chi·ªÅu r·ªông */
        }
        .option-label { font-weight: bold; margin-bottom: 8px; color: #555; }
        input[type="radio"] { transform: scale(1.3); cursor: pointer; margin: 0; }

        .matrix-row { display: flex; align-items: center; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed #eee; }
        .tf-group { display: flex; gap: 20px; }
        .tf-item { display: flex; flex-direction: column; align-items: center; cursor: pointer; }
        /* -------------------- */

        .warning-box { background: #fff3cd; color: #856404; padding: 10px; border-radius: 5px; margin: 20px 0; border: 1px solid #ffeeba; text-align: center; font-weight: bold; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 20px auto; display: none;}
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .hidden { display: none; }

	/* Spinner nh·ªè n·∫±m trong n√∫t b·∫•m */
	.btn-loader {
    		border: 3px solid rgba(255,255,255,0.3);
    		border-top: 3px solid white;
    		border-radius: 50%;
    		width: 20px;
    		height: 20px;
    		animation: spin 1s linear infinite;
    		display: inline-block;
    		vertical-align: middle;
    		margin-right: 10px;
	}
	/* Tr·∫°ng th√°i n√∫t khi ƒëang x·ª≠ l√Ω */
		.btn:disabled {
    		background-color: #95a5a6; /* M√†u x√°m */
    		cursor: not-allowed;
    		opacity: 0.8;
	}

	/* Th√™m v√†o trong th·∫ª <style> */
	.footer-credit {
    		margin-top: 40px;
    		font-size: 12px;
    		color: #999;
    		text-align: center;
    		border-top: 1px solid #eee;
    		padding-top: 15px;
    		font-family: monospace; /* Font ch·ªØ ki·ªÉu code cho ng·∫ßu */
	}
/*ƒêo·∫°n n√†y c·ªßa meme*/
	/* N√∫t hover ƒë·∫πp h∆°n */
    #meme-button:hover {
        background: #2dd8bc;  /* T·ªëi h∆°n ch√∫t khi hover */
        transform: translateY(-2px);
        transition: all 0.3s ease;
    }

    /* Meme responsive ho√†n h·∫£o tr√™n m·ªçi thi·∫øt b·ªã, ƒë·∫∑c bi·ªát mobile */
    .meme-img {
        max-width: 100%;     /* Kh√¥ng v∆∞·ª£t qu√° chi·ªÅu r·ªông m√†n h√¨nh/container */
        max-height: 300px;   /* Gi·ªØ chi·ªÅu cao t·ªëi ƒëa */
        height: auto;        /* T·ª± ƒëi·ªÅu ch·ªânh t·ª∑ l·ªá */
        width: auto;         /* Gi·ªØ t·ª∑ l·ªá g·ªëc */
        border-radius: 12px;
        box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        opacity: 0;
        transition: opacity 0.6s ease;
        display: block;      /* Tr√°nh l·ªói inline spacing */
        margin: 0 auto;      /* CƒÉn gi·ªØa ch√≠nh x√°c */
    }

    /* ƒê·∫£m b·∫£o kh√¥ng tr√†n khung n·∫øu c√≥ v·∫•n ƒë·ªÅ overflow */
    #meme-container {
        overflow: hidden;    /* ·∫®n ph·∫ßn tr√†n n·∫øu c√≥ (an to√†n) */
    }
	
	/* CSS cho Popup chuy√™n nghi·ªáp */
.custom-modal {
    display: none; 
    position: fixed; 
    top: 0; left: 0; 
    width: 100%; height: 100%; 
    background: rgba(0, 0, 0, 0.6); /* L√†m t·ªëi n·ªÅn */
    backdrop-filter: blur(5px); /* L√†m m·ªù n·ªÅn sau */
    z-index: 9999;
    justify-content: center; 
    align-items: center;
    animation: fadeIn 0.3s ease;
}

/* 1. S·ª≠a l·∫°i khung ch·ª©a n·ªôi dung */
.modal-content {
    background: white;
    padding: 20px; /* Gi·∫£m padding m·ªôt ch√∫t ƒë·ªÉ ti·∫øt ki·ªám kh√¥ng gian */
    border-radius: 20px;
    width: 90%;
    max-width: 450px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.2);
    
    /* TH√äM 3 D√íNG N√ÄY */
    max-height: 75vh;    /* Gi·ªõi h·∫°n chi·ªÅu cao t·ªëi ƒëa b·∫±ng 85% m√†n h√¨nh */
    display: flex;       /* Chuy·ªÉn sang d·∫°ng flex ƒë·ªÉ s·∫Øp x·∫øp c√°c ph·∫ßn b√™n trong */
    flex-direction: column; 
}

.modal-header {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 20px;
    color: #2c3e50;
}

/* 2. S·ª≠a l·∫°i ph·∫ßn ch·ª©a ch·ªØ (ph·∫ßn n√†y s·∫Ω c√≥ thanh cu·ªôn) */
.modal-body {
    text-align: left;
    line-height: 1.6;
    color: #444;
    margin-bottom: 20px;

    /* TH√äM 2 D√íNG N√ÄY */
    overflow-y: auto;    /* Hi·ªán thanh cu·ªôn d·ªçc khi n·ªôi dung qu√° d√†i */
    padding-right: 10px; /* T·∫°o kho·∫£ng tr·ªëng ƒë·ªÉ thanh cu·ªôn kh√¥ng ƒë√® l√™n ch·ªØ */
}
/* T√πy ch·ªânh thanh cu·ªôn cho Popup */
.modal-body::-webkit-scrollbar {
    width: 6px;
}
.modal-body::-webkit-scrollbar-thumb {
    background-color: #52cca1; /* M√†u xanh c·ªßa b·∫°n */
    border-radius: 10px;
}


.btn-close {
    background: #3498db;
    color: white;
    border: none;
    padding: 10px 25px;
    border-radius: 50px;
    cursor: pointer;
    font-weight: bold;
    transition: 0.3s;
}

.btn-close:hover {
    background: #2980b9;
    transform: scale(1.05);
}

/* Hi·ªáu ·ª©ng rung ƒë·ªông cho popup ƒë·∫∑c bi·ªát */
.special-border {
    border: 3px solid #f1c40f;
}

@keyframes fadeIn {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}

/* LOGO */
.brand-logo-container {
        text-align: center;        /* CƒÉn gi·ªØa logo */
        padding: 5px 0;           /* Kho·∫£ng c√°ch tr√™n d∆∞·ªõi */
        margin: 0 auto;            /* ƒê·∫£m b·∫£o cƒÉn gi·ªØa */
    }

    .brand-logo-link {
        display: inline-block;     /* Gi√∫p link √¥m s√°t ·∫£nh */
        text-decoration: none;     /* B·ªè g·∫°ch ch√¢n link */
    }

	.brand-logo {
        height: auto;
        display: block;
        margin: 0 auto;
        
        /* Gi·ªõi h·∫°n t·ªëi ƒëa 600px tr√™n m√†n h√¨nh l·ªõn */
        max-width: 600px;
        
        /* Tr√™n m√†n h√¨nh l·ªõn, s·∫Ω hi·ªÉn th·ªã t·ªëi ƒëa 600px (kh√¥ng v∆∞·ª£t qu√°) */
        width: 100%;                   /* Chi·∫øm full n·∫øu nh·ªè h∆°n 600px */
    }

    /* Responsive cho m√†n h√¨nh trung b√¨nh v√† nh·ªè */
    @media (max-width: 992px) {
        .brand-logo {
            max-width: 90%;            /* V·∫´n gi·ªØ % ƒë·ªÉ co gi√£n ƒë·∫πp */
        }
    }

    @media (max-width: 768px) {
        .brand-logo-container {
            padding: 15px 0;
        }
        .brand-logo {
            max-width: 95%;
        }
    }

    @media (max-width: 480px) {
        .brand-logo {
            max-width: 100%;
        }
    }
	
    </style>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
    /* Th√™m CSS cho d√≤ng l·ªùi nh·∫Øn */
    .feedback-msg {
        margin-top: 15px;
        padding: 15px;
        border-radius: 8px;
        /* font-style: italic; */
        text-align: center;
        font-size: 1.1em;
        animation: fadeIn 1s ease-in;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    
    /* M√†u s·∫Øc theo m·ª©c ƒë·ªô */
    .fb-low { background: #fff5f5; color: #c53030; border-left: 5px solid #c53030; } /* ƒê·ªè */
    .fb-mid { background: #fffaf0; color: #d69e2e; border-left: 5px solid #d69e2e; } /* V√†ng cam */
    .fb-high { background: #f0fff4; color: #2f855a; border-left: 5px solid #2f855a; } /* Xanh l√° */
</style>
</head>
<body>

<div class="container">
    <div id="loader" class="loader"></div>
    
<div id="main-screen">
<!-- LOGO -->
<div class="brand-logo-container">
    <img src="https://i.postimg.cc/RVDS2S58/TTQ4.jpg" 
    alt="To√°n Th·∫ßy Qu√¢n" 
    class="brand-logo">
</div>
        
        <p class="brand-subtitle" id="slogan-display">ChƒÉm h·ªçc To√°n - S√°ng t∆∞∆°ng lai</p>
        
        <input type="text" id="hs-name" placeholder="H·ªç v√† t√™n h·ªçc sinh">
        <input type="text" id="exam-code" placeholder="Nh·∫≠p M√£ ƒê·ªÅ Thi (Ch√∫ √Ω VI·∫æT HOA)">
        <button class="btn" onclick="vaoThi()">B·∫ÆT ƒê·∫¶U L√ÄM B√ÄI</button>
		
		<button class="btn" style="background-color: #4cd964; color: white;" onclick="xuLyBamNut(event)">
    H∆∞·ªõng d·∫´n h·ªçc t·∫≠p
		</button>
		
<div id="modal-huong-dan" class="custom-modal">
    <div class="modal-content">
        <div class="modal-header"><center>H∆∞·ªõng d·∫´n h·ªçc t·∫≠p</center></div>
        <div class="modal-body">
    <p>1. Trang web n√†y kh√¥ng hi·ªÉn th·ªã n·ªôi dung c√¢u h·ªèi. Em h√£y l√†m b√†i tr√™n phi·∫øu b√†i t·∫≠p do Th·∫ßy/C√¥ ph√°t, sau ƒë√≥ nh·∫≠p ƒë√°p √°n t∆∞∆°ng ·ª©ng l√™n ƒë√¢y.</p>
    <p>2. Sau khi n·ªôp b√†i, em s·∫Ω xem ƒë∆∞·ª£c ƒëi·ªÉm s·ªë v√† bi·∫øt c√¢u n√†o ƒë√∫ng, c√¢u n√†o sai. H√£y xem l·∫°i c√°c c√¢u sai, l√†m l·∫°i c·∫©n th·∫≠n v√† t√¨m ƒë√°p √°n ƒë√∫ng. Vi·ªác h·ªçc t·ª´ sai l·∫ßm r·∫•t quan tr·ªçng.</p>
    <p>3. Khi c√≥ c√¢u sai, h·ªá th·ªëng s·∫Ω hi·ªÉn th·ªã n√∫t ‚ÄúS·ª≠a sai ‚Äì Grow your mind‚Äù. H√£y s·ª≠ d·ª•ng n√∫t n√†y ƒë·ªÉ nh·∫≠p v√† ki·ªÉm tra l·∫°i k·∫øt qu·∫£ c·ªßa c√°c c√¢u sai tr∆∞·ªõc ƒë√≥.</p>
    <p>4. H√£y nh·∫≠p ƒë·∫ßy ƒë·ªß, ch√≠nh x√°c t√™n c·ªßa em tr∆∞·ªõc khi l√†m b√†i. ƒê√≥ l√† c√°ch th·ªÉ hi·ªán s·ª± tr√¢n tr·ªçng, y√™u th∆∞∆°ng c√°i t√™n c·ªßa ch√≠nh m√¨nh.</p>

    <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
    <div style="color: #808080; font-size: 15px; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; line-height: 1.5; font-style: italic;">
        <p>
            Ph√≠a tr√™n l√† h∆∞·ªõng d·∫´n h·ªçc t·∫≠p, c√≤n ƒë·ªÉ xem ƒë∆∞·ª£c 
            B√≠ k√≠p h·ªçc t·∫≠p h√£y l√†m nh∆∞ sau: V√†o trang web n√†y b·∫±ng ƒëi·ªán tho·∫°i, b·∫•m nhanh v√†o 
            n√∫t ‚ÄúH∆∞·ªõng d·∫´n h·ªçc t·∫≠p‚Äù nhi·ªÅu h∆°n <strong>n</strong> l·∫ßn. Khi ƒë√≥ b√≠ k√≠p th·ª±c s·ª± s·∫Ω hi·ªán ra.
        </p>
        
        <div style="font-size: 13px; margin-top: 10px; border-left: 3px solid #52cca1; padding-left: 10px;">
            L∆∞u √Ω:<br>
            * B·∫•m th·∫≠t nhanh ƒë·ªÉ kh√¥ng hi·ªán l·∫°i b·∫£ng h∆∞·ªõng d·∫´n n√†y.<br>
            ** <strong>n</strong> l√† k·∫øt qu·∫£ c·ªßa ph√©p t√≠nh:<br><center>[T√≠ch hai s·ªë nguy√™n t·ªë ƒë·∫ßu ti√™n ‚ûñ (NƒÉm hi·ªán t·∫°i)üß¢(X√°c su·∫•t m·ªôt ng∆∞·ªùi ƒë∆∞·ª£c sinh ra v√†o ng√†y 30 th√°ng 2)]‚ùå(S·ªë l·∫ßn chi·∫øn tranh th·∫ø gi·ªõi ƒë√£ x·∫£y ra)</center>
        </div>
    </div>
</div>
        <button class="btn-close" onclick="dongModal('modal-huong-dan')">ƒê√£ s·∫µn s√†ng</button>
    </div>
</div>

<div id="modal-bi-mat" class="custom-modal">
    <div class="modal-content special-border">
        <div class="modal-header" style="color: #e74c3c;"><center>B√ç K√çP H·ªåC T·∫¨P</center></div>
        <div class="modal-body">
            <p><b>Ch√∫c m·ª´ng b·∫°n ƒë√£ m·ªü ra ƒë∆∞·ª£c b√≠ k√≠p</b>üéâüåüü•≥ ƒê·ªÉ ƒë·ªçc ƒë∆∞·ª£c nh·ªØng d√≤ng n√†y, b·∫°n ƒë√£ th·ª±c hi·ªán ch√≠nh x√°c theo h∆∞·ªõng d·∫´n, n·ªó l·ª±c b·∫•m r·∫•t nhanh v√† ki√™n tr√¨ b·∫•m h∆°n 10 l·∫ßn!</p>
            <img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExMXhoMmVsa2pmZjhwNWgwMmdoNTdhMHpqbXFzMGhnMmVwYjM5ejhzNiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/ox5i4KGCCx2OFbv7Aq/giphy.gif" alt="Secret Image" style="width:100%; border-radius:12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
            <p style="margin-top:10px; font-style: italic;">Ch√∫c b·∫°n c√≥ h√†nh tr√¨nh h·ªçc t·∫≠p th√∫ v·ªã v√† th√†nh c√¥ng!</p>
			<p style="color: gray; font-style: italic;">H√£y gi·ªØ k√≠n b√≠ k√≠p n√†y nh√© ü§´</p>
        </div>
        <button class="btn-close" onclick="dongModal('modal-bi-mat')">Tuy·ªát v·ªùi</button>
    </div>
</div>

<div id="modal-sieu-bi-mat" class="custom-modal">
    <div class="modal-content" style="border: 3px double #ff4757;"> <div class="modal-header" style="color: #ff4757;"><center>ƒê√¢y kh√¥ng ph·∫£i b√≠ k√≠p</center></div>
        <div class="modal-body" style="text-align: center;">
            <p> üòÆ B·∫•m t·ªõi t·∫≠n ƒë√¢y sao? ƒê√£ qua s·ªë l·∫ßn b·∫•m ƒë·ªÉ ƒë·ªçc b√≠ k√≠p. B·∫°n ƒë·ªçc r·ªìi ch·ª©?</p>
            <img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExamRuNzBtcHQydDB2NjE5bzViZmFvbmphbXd3cHBtNmV4OXl0Ym9lcCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/EE1nWSWho921w4m1IS/giphy.gif" style="width:100%; border-radius:15px; margin: 10px 0;"></center>
			<p>V√¨ b·∫°n ƒëang r·∫£nh n√™n h√£y ch∆°i tr√≤ ƒê·ªë ch·ªØ nh√©. M·ªói c√¢u h·ªèi d∆∞·ªõi ƒë√¢y c√≥ ƒë√°p √°n l√† m·ªôt t·ª´ ƒë∆°n Ti·∫øng Vi·ªát. Sau khi t√¨m ƒë·ªß 4 t·ª´, gh√©p ch√∫ng l·∫°i th√†nh m·ªôt c√¢u.</p>
			<div class="modal-body">
			<p>1. T·ª´ n√†y ch·ªâ h√†nh ƒë·ªông l·∫∑p ƒëi l·∫∑p l·∫°i m·ªôt k·ªπ nƒÉng n√†o ƒë√≥ ƒë·ªÉ tr·ªü n√™n th√†nh th·∫°o (v√≠ d·ª•: ... üèäüèº‚Äç, ... ‚úçÔ∏è)?</p>
			<p>2. Ti·∫øng ƒë·∫ßu ti√™n trong m·ªôt t√≠nh t·ª´ d√πng ƒë·ªÉ ch·ªâ s·ª± th√†nh th·∫≠t, ngay th·∫≥ng, kh√¥ng bao gi·ªù gian d·ªëi hay l·ª´a l·ªçc ng∆∞·ªùi kh√°c?</p>
			<p>3. T·ª´ n√†y ch·ªâ h√†nh ƒë·ªông ti·∫øp thu ki·∫øn th·ª©c, luy·ªán t·∫≠p k·ªπ nƒÉng d∆∞·ªõi s·ª± h∆∞·ªõng d·∫´n c·ªßa th·∫ßy c√¥ ho·∫∑c t·ª± m√¨nh t√¨m t√≤i qua s√°ch v·ªü?</p>
			<p>4. ƒê√¢y l√† t·ª´ ch·ªâ m·ªôt h√†nh ƒë·ªông di chuy·ªÉn c·ªßa con ng∆∞·ªùi b·∫±ng ch√¢n, c√≥ t·ªëc ƒë·ªô ch·∫≠m h∆°n üèÉ v√† nhanh h∆°n üêÑ?</p>
        </div>
		</div>
		<center><button class="btn-close" onclick="dongModal('modal-sieu-bi-mat')">Ok, I understand!</button></center>
    </div>
</div>



        <button class="btn btn-outline" onclick="showLoginAdmin()" style="font-size: 0.85em; padding: 8px;">D√†nh cho Gi√°o vi√™n</button>

        <div class="footer-credit">Design by Qu√¢nPT</div>
    </div>

    <div id="login-admin" class="hidden">
        <h2>Gi√°o vi√™n ƒêƒÉng nh·∫≠p</h2>
        <input type="password" id="admin-pass" placeholder="M·∫≠t kh·∫©u">
        <button class="btn" onclick="loginAdmin()">V√†o qu·∫£n tr·ªã</button>
        <button class="btn btn-outline" onclick="location.reload()">Quay l·∫°i</button>
    </div>

    <div id="admin-panel" class="hidden">
        <a href="https://mrquan9x-2025.github.io/quanlythiv3/" style="text-decoration: none;">
            <button class="btn btn-outline" style="margin-bottom: 20px; border-color: #28a745; color: #28a745; font-weight: bold;">
                üìä TH·ªêNG K√ä K·∫æT QU·∫¢ THI
            </button>
        </a>
        <hr style="border: 0; border-top: 1px solid #eee; margin-bottom: 20px;">

        <h2>T·∫°o ƒê·ªÅ Thi M·ªõi</h2>
        <input type="text" id="new-exam-code" placeholder="M√£ ƒë·ªÅ (VI·∫æT HOA, kh√¥ng c√≥ d·∫•u. V√≠ d·ª•: 12TOAN5)">
        <input type="text" id="new-exam-name" placeholder="T√™n ƒë·ªÅ thi">

        <div class="config-group">
            <div class="section-header" style="margin-top:0">C·∫•u h√¨nh Ph·∫ßn 1 (Tr·∫Øc nghi·ªám)</div>
            <div class="config-row">
                <div><label class="config-label">S·ªë c√¢u:</label><input type="number" id="cfg-p1-num" value="12"></div>
                <div><label class="config-label">ƒêi·ªÉm/c√¢u:</label><input type="number" id="cfg-p1-score" value="0.25" step="0.01"></div>
            </div>
        </div>

        <div class="config-group">
            <div class="section-header">C·∫•u h√¨nh Ph·∫ßn 2 (ƒê√∫ng/Sai)</div>
            <div class="config-row">
                <div><label class="config-label">S·ªë c√¢u:</label><input type="number" id="cfg-p2-num" value="4"></div>
                <div><label class="config-label">T√≠nh ƒëi·ªÉm:</label>
                    <select id="cfg-p2-mode">
                        <option value="bac_thang">B·∫≠c thang (0.1 - 0.25 - 0.5 - 1)</option>
                        <option value="chia_deu">Chia ƒë·ªÅu (0.25ƒë / √Ω)</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="config-group">
            <div class="section-header">C·∫•u h√¨nh Ph·∫ßn 3 (Tr·∫£ l·ªùi ng·∫Øn)</div>
            <div class="config-row">
                <div><label class="config-label">S·ªë c√¢u:</label><input type="number" id="cfg-p3-num" value="6"></div>
                <div><label class="config-label">ƒêi·ªÉm/c√¢u:</label><input type="number" id="cfg-p3-score" value="0.5" step="0.01"></div>
            </div>
        </div>

        <div style="background: #e2e6ea; padding: 10px; margin: 10px 0; border-radius: 5px; font-size: 0.9em;">
            <strong>H∆∞·ªõng d·∫´n:<br> </strong> 
             a) T·ªïng ƒëi·ªÉm c√°c c√¢u trong ƒë·ªÅ thi kh√¥ng b·∫Øt bu·ªôc ph·∫£i b·∫±ng 10. Tuy nhi√™n, ƒë·ªÉ s·ª≠ d·ª•ng t·ªët c√°c ch·ª©c nƒÉng "L·ªùi nh·∫Øc" d√†nh cho h·ªçc sinh v√† "Xem ph·ªï ƒëi·ªÉm" th√¨ n√™n ƒë·ªÉ ƒëi·ªÉm t·ªëi ƒëa b·∫±ng 10 (ho·∫∑c x·∫•p x·ªâ 10).<br> 
             b) D√πng d·∫•u ch·∫•m (.) ƒë·ªÉ vi·∫øt s·ªë th·∫≠p ph√¢n.<br>
        	 c) Nh·∫≠p li√™n ti·∫øp ƒë√°p √°n t·ª´ tr√™n xu·ªëng d∆∞·ªõi (H·∫øt P1 > P2 > P3). V√≠ d·ª•:<br>
				1. A<br>
				2. B<br>
				3. ƒêSƒêS<br>
				4. 5.25
        </div>
        <textarea id="exam-data-input" rows="8" placeholder="D√°n ƒë√°p √°n v√†o ƒë√¢y..."></textarea>
        
        <button class="btn" onclick="luuDeThi(event)">L∆∞u ƒê·ªÅ Thi</button>
        <button class="btn btn-outline" onclick="location.reload()">Tho√°t</button>
    </div>

    <div id="exam-interface" class="hidden">
        <h2 id="exam-title-display"></h2>
        <div id="questions-container"></div>
        <button class="btn" onclick="nopBai()">N·ªòP B√ÄI</button>
    </div>

    <div id="result-interface" class="hidden">
        <h2>K·∫æT QU·∫¢: <span id="score-display" style="color:red; font-size: 2em"></span></h2>
        <div id="result-details"></div>
        <button id="btn-fix-mistakes" class="btn" style="background-color: #f39c12; margin-bottom: 10px; display: none;" onclick="cheDoSuaSai()">
            S·ª≠a sai - Grow Your Mind
        </button>
		<button class="btn" onclick="location.reload()">L√†m ƒë·ªÅ kh√°c</button>
    </div>
</div>

<script>
// --- C·∫§U H√åNH SLOGAN NG·∫™U NHI√äN ---
    // Th·∫ßy thay n·ªôi dung 5 c√¢u n√≥i ·ªü ƒë√¢y nh√©:
    const listSlogans = [
        "ChƒÉm h·ªçc To√°n - S√°ng t∆∞∆°ng lai",
        "C√°ch duy nh·∫•t ƒë·ªÉ H·ªçc To√°n l√† L√†m To√°n",
        "M·ªói ng√†y h·ªçc t·∫≠p l√† m·ªôt c∆° h·ªôi ƒë·ªÉ tr·ªü th√†nh phi√™n b·∫£n t·ªët h∆°n c·ªßa ch√≠nh m√¨nh",
        "H√£y h·ªçc khi ng∆∞·ªùi kh√°c ng·ªß, lao ƒë·ªông khi ng∆∞·ªùi kh√°c l∆∞·ªùi nh√°c, chu·∫©n b·ªã khi ng∆∞·ªùi kh√°c ch∆°i b·ªùi v√† c√≥ ƒë∆∞·ª£c gi·∫•c m∆° c·ªßa m√¨nh khi m·ªçi ng∆∞·ªùi ch·ªâ ao ∆∞·ªõc.",
        "H·ªçc t·∫≠p gi·ªëng nh∆∞ ch√®o thuy·ªÅn ng∆∞·ª£c d√≤ng, kh√¥ng ti·∫øn ·∫Øt s·∫Ω l√πi"
    ];

    // T·ª± ƒë·ªông ch·ªçn 1 c√¢u v√† hi·ªÉn th·ªã khi trang web t·∫£i xong
    document.addEventListener("DOMContentLoaded", function() {
        const randomSlogan = listSlogans[Math.floor(Math.random() * listSlogans.length)];
        const sloganElement = document.getElementById('slogan-display');
        if(sloganElement) sloganElement.innerText = randomSlogan;
    });
    // -----------------------------------

    // --- H√ÄM CHU·∫®N H√ìA H·ªå T√äN TI·∫æNG VI·ªÜT ---
    function chuanHoaTen(str) {
        // 1. X√≥a kho·∫£ng tr·∫Øng th·ª´a ·ªü ƒë·∫ßu, cu·ªëi v√† gi·ªØa c√°c t·ª´
        str = str.trim().replace(/\s+/g, ' ');
        // 2. Chuy·ªÉn t·∫•t c·∫£ v·ªÅ ch·ªØ th∆∞·ªùng, sau ƒë√≥ vi·∫øt hoa ch·ªØ c√°i ƒë·∫ßu m·ªói t·ª´
        return str.toLowerCase().replace(/(^|\s)\S/g, function(l) { 
            return l.toUpperCase(); 
        });
    }

    // --- THAY LINK API C·ª¶A TH·∫¶Y V√ÄO ƒê√ÇY ---
    const API_URL = "https://script.google.com/macros/s/AKfycbwrijo6SO5gMM5u7Adr24IaUA7_UoDmb5GKHzNWABLZ-tIK1Fr6FyOpEmX_8Xa4h2pc/exec"; 
    // ---------------------------------------

    let currentExamConfig = {};
    let currentExamQuestions = [];
    let studentName = "";
    let examCode = "";

    function showLoader(show) { document.getElementById('loader').style.display = show ? 'block' : 'none'; }
    function hideAll() {
        document.getElementById('main-screen').style.display = 'none';
        document.getElementById('login-admin').style.display = 'none';
        document.getElementById('admin-panel').style.display = 'none';
        document.getElementById('exam-interface').style.display = 'none';
        document.getElementById('result-interface').style.display = 'none';
    }

    async function vaoThi() {
         // --- C·∫¨P NH·∫¨T: X·ª¨ L√ù H·ªå T√äN TH√îNG MINH ---
        const nameInput = document.getElementById('hs-name');
        let rawName = nameInput.value;
        
        // B∆∞·ªõc 1: Chu·∫©n h√≥a (T·ª± ƒë·ªông vi·∫øt hoa ch·ªØ c√°i ƒë·∫ßu)
        let cleanName = chuanHoaTen(rawName);
        
        // B∆∞·ªõc 2: Ki·ªÉm tra ƒë·ªô d√†i (Ph·∫£i c√≥ √≠t nh·∫•t 2 t·ª´)
        if (!cleanName || cleanName.split(' ').length < 2) {
            alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß H·ªç v√† T√™n (V√≠ d·ª•: Nguy·ªÖn VƒÉn An)");
            nameInput.focus();
            return;
        }

        // B∆∞·ªõc 3: G√°n l·∫°i t√™n ƒë√£ chu·∫©n h√≥a v√†o √¥ input ƒë·ªÉ h·ªçc sinh nh√¨n th·∫•y
        nameInput.value = cleanName;
        studentName = cleanName; // L∆∞u v√†o bi·∫øn to√†n c·ª•c
        // ------------------------------------------

        const code = document.getElementById('exam-code').value.trim();
        examCode = code; // L∆∞u m√£ ƒë·ªÅ

        if (!studentName || !examCode) {
            alert("Vui l√≤ng nh·∫≠p ƒë·ªß H·ªç T√™n v√† M√£ ƒë·ªÅ!");
            return;
        }


        showLoader(true);
        try {
            const res = await fetch(`${API_URL}?action=get_exam&maDe=${examCode}&t=${Date.now()}`).then(r => r.json());
            if(res.status === 'error') { alert(res.msg); showLoader(false); return; }
            
            hideAll();
            document.getElementById('exam-interface').style.display = 'block';
            document.getElementById('exam-title-display').innerText = res.data.tenDe;
            
            currentExamConfig = res.data.config;
            currentExamQuestions = res.data.cauHoi;
            renderQuestions(res.data.cauHoi, res.data.config);
        } catch(e) { console.error(e); alert("L·ªói k·∫øt n·ªëi!"); }
        showLoader(false);
    }

    function renderQuestions(list, config) {
        let html = '';
        let p1_end = parseInt(config.p1_num);
        let p2_end = p1_end + parseInt(config.p2_num);

        list.forEach((c, i) => {
            if (i === 0 && config.p1_num > 0) html += `<div class="section-header">PH·∫¶N 1: TR·∫ÆC NGHI·ªÜM (${config.p1_score}ƒë/c√¢u)</div>`;
            if (i === p1_end && config.p2_num > 0) html += `<div class="section-header">PH·∫¶N 2: ƒê√öNG/SAI (${config.p2_mode === 'chia_deu' ? 'Chia ƒë·ªÅu' : 'B·∫≠c thang'})</div>`;
            if (i === p2_end && config.p3_num > 0) {
                html += `<div class="section-header">PH·∫¶N 3: TR·∫¢ L·ªúI NG·∫ÆN (${config.p3_score}ƒë/c√¢u)</div>`;
                html += `<div class="warning-box">‚ö†Ô∏è L∆∞u √Ω: D√πng d·∫•u ch·∫•m ƒë·ªÉ nh·∫≠p s·ªë th·∫≠p ph√¢n (V√≠ d·ª•: 2.5)</div>`;
            }

            html += `<div class="question-box"><span class="q-title">C√¢u ${c.id}:</span>`;

            if(c.dang === 1) { 
                html += `<div class="options-grid">`;
                ['A','B','C','D'].forEach(opt => {
                    html += `<label class="option-item"><span class="option-label">${opt}</span><input type="radio" name="c${i}" value="${opt}"></label>`;
                });
                html += `</div>`;
            } 
            else if(c.dang === 2) { 
                html += `<div>`;
                ['a','b','c','d'].forEach((y, yi) => {
                    html += `<div class="matrix-row"><span class="matrix-label">√ù ${y}:</span> 
                        <div class="tf-group">
                            <label class="tf-item"><span class="tf-text">ƒê</span><input type="radio" name="c${i}_${yi}" value="true"></label> 
                            <label class="tf-item"><span class="tf-text">S</span><input type="radio" name="c${i}_${yi}" value="false"></label>
                        </div></div>`;
                });
                html += `</div>`;
            } 
            else { 
                html += `<input type="text" id="c${i}" autocomplete="off" placeholder="Nh·∫≠p k·∫øt qu·∫£...">`;
            }
            html += `</div>`;
        });
        document.getElementById('questions-container').innerHTML = html;
    }

    async function nopBai() {
        if(!confirm("B·∫°n mu·ªën n·ªôp b√†i? Ch·ªù 3 gi√¢y ƒë·ªÉ xem k·∫øt qu·∫£!")) return;
        // 1. L·∫§Y N√öT V√Ä KH√ìA N√öT L·∫†I NGAY L·∫¨P T·ª®C
        const btnSubmit = document.querySelector('#exam-interface .btn'); 
        const originalText = btnSubmit.innerHTML; // L∆∞u l·∫°i ch·ªØ "N·ªòP B√ÄI" c≈©
        
        // ƒê·ªïi giao di·ªán n√∫t -> ƒêang loading
        btnSubmit.disabled = true;
        btnSubmit.innerHTML = '<div class="btn-loader"></div> ƒêang ch·∫•m ƒëi·ªÉm...';

	// 2. Thu th·∫≠p d·ªØ li·ªáu b√†i l√†m (Gi·ªØ nguy√™n logic c≈©)
        let baiLam = [];
        currentExamQuestions.forEach((c, i) => {
            if(c.dang === 1) {
                const el = document.querySelector(`input[name="c${i}"]:checked`);
                baiLam.push(el ? el.value : "");
            } else if(c.dang === 2) {
                let ans = [];
                for(let j=0; j<4; j++) {
                    const el = document.querySelector(`input[name="c${i}_${j}"]:checked`);
                    ans.push(el ? (el.value === 'true') : null);
                }
                baiLam.push(ans);
            } else {
                let val = document.getElementById(`c${i}`).value.replace(',', '.');
                baiLam.push(val);
            }
        });
        // 3. G·ª≠i d·ªØ li·ªáu ƒëi
        showLoader(true);
        const formData = new FormData();
        formData.append('action', 'submit_exam');
        formData.append('maDe', examCode);
        formData.append('tenHS', studentName);
        formData.append('baiLam', JSON.stringify(baiLam));

        try {
            const res = await fetch(API_URL, { method: 'POST', body: formData }).then(r => r.json());
            showLoader(false);
            // N·∫øu l·ªói th√¨ m·ªü l·∫°i n√∫t ƒë·ªÉ n·ªôp l·∫°i
            if(res.status === 'error') { 
                alert(res.msg); 
                btnSubmit.disabled = false;
                btnSubmit.innerHTML = originalText;
                return; 
            }

// ... (Ph·∫ßn tr√™n gi·ªØ nguy√™n) ...
            
            hideAll();
            document.getElementById('result-interface').style.display = 'block';
			// --- ƒêO·∫†N CODE M·ªöI TH√äM: X·ª¨ L√ù N√öT S·ª¨A SAI ---
            window.ketQuaChiTiet = res.chiTiet; // L∆∞u k·∫øt qu·∫£ l·∫°i ƒë·ªÉ d√πng
            // N·∫øu ƒëi·ªÉm < 10 (t·ª©c l√† c√≥ c√¢u sai) th√¨ hi·ªán n√∫t S·ª≠a sai
            if (res.diem < (currentExamConfig.p1_num * currentExamConfig.p1_score + currentExamConfig.p2_num * 1 + currentExamConfig.p3_num * currentExamConfig.p3_score)) { 
                 document.getElementById('btn-fix-mistakes').style.display = 'block';
            } else {
                 document.getElementById('btn-fix-mistakes').style.display = 'none';
            }
            // ---------------------------------------------
			
            document.getElementById('score-display').innerText = res.diem.toFixed(2);
            
            // --- PH·∫¶N M·ªöI: HI·ªÇN TH·ªä L·ªúI NH·∫ÆN ƒê·ªòNG VI√äN ---
            const diem = res.diem;
            const ten = studentName.split(' ').pop(); // L·∫•y t√™n (v√≠ d·ª• "Nguy·ªÖn VƒÉn A" -> "A")
            let msg = "";
            let msgClass = "";

           // Ng√¢n h√†ng l·ªùi nh·∫Øn
            const msgList = {
                lv1: ["V·∫°n s·ª± kh·ªüi ƒë·∫ßu nan üå±, ƒë·ª´ng n·∫£n ch√≠ {ten} nh√©! üí™", "Th·∫•t b·∫°i l√† m·∫π th√†nh c√¥ng üê£, c·ªë l√™n {ten} ∆°i! üöÄ", "C·∫ßn √¥n k·ªπ l·∫°i l√Ω thuy·∫øt nha {ten} üìö, em s·∫Ω ti·∫øn b·ªô nhanh th√¥i! üí™", "ƒê·ª´ng bu·ªìn nh√© {ten} ü§ó, l·∫ßn sau ch·∫Øc ch·∫Øn s·∫Ω t·ªët h∆°n nhi·ªÅu! üåà", "C·ªë g·∫Øng h∆°n ch√∫t n·ªØa nh√© {ten} üí™, m·ªói l·∫ßn th·ª≠ l√† m·ªôt b∆∞·ªõc ti·∫øn r·ªìi! üèÉ", "{ten} ∆°i, ƒëi·ªÉm l·∫ßn n√†y gi·ªëng Einstein l√∫c nh·ªè l·∫Øm üòÑ, √¥ng ·∫•y t·ª´ng b·ªã cho l√† ‚Äúch·∫≠m hi·ªÉu‚Äù m√† sau thay ƒë·ªïi c·∫£ th·∫ø gi·ªõi! C·ªë l√™n nh√©!Ô∏è", "Nobita c≈©ng hay ƒë∆∞·ª£c ƒëi·ªÉm ki·ªÉu n√†y n√® {ten} √† üòÇ, nh∆∞ng c·∫≠u ·∫•y v·∫´n c√≥ b·∫°n b√® v√† th·∫ßy c√¥ gi√∫p, em c≈©ng th·∫ø. C·ªë l√™n nh√©!Ô∏èüí™"],
                lv2: ["ƒê√£ c√≥ c·ªë g·∫Øng üëç, nh∆∞ng c·∫ßn t·∫≠p trung h∆°n nha {ten} ‚ö°", "C·∫©n th·∫≠n h∆°n ch√∫t n·ªØa nh√© {ten} üìù, phong ƒë·ªô s·∫Ω l√™n nhanh th√¥i üòâ", "C·∫©n th·∫≠n h∆°n x√≠u n·ªØa l√† ƒëi·ªÉm cao ngay th√¥i {ten} ∆°i üéØ", "√în luy·ªán b√†i t·∫≠p c∆° b·∫£n nhi·ªÅu h∆°n nh√© {ten} üìö", "Ti·∫øp t·ª•c n·ªó l·ª±c nh√© {ten} üí™, s·∫Øp ch·∫°m m·ªëc Kh√° r·ªìi üåª", "{ten} ∆°i, ƒëi·ªÉm l·∫ßn n√†y gi·ªëng Einstein l√∫c nh·ªè l·∫Øm üòÑ, √¥ng ·∫•y t·ª´ng b·ªã cho l√† ‚Äúch·∫≠m hi·ªÉu‚Äù m√† sau thay ƒë·ªïi c·∫£ th·∫ø gi·ªõi! C·ªë l√™n nh√©!Ô∏è", "Nobita c≈©ng hay ƒë∆∞·ª£c ƒëi·ªÉm ki·ªÉu n√†y n√® {ten} √† üòÇ, nh∆∞ng c·∫≠u ·∫•y v·∫´n c√≥ b·∫°n b√® v√† th·∫ßy c√¥ gi√∫p, em c≈©ng th·∫ø. C·ªë l√™n nh√©!Ô∏è üí™"],
                lv3: ["K·∫øt qu·∫£ kh√° ƒë√≥ üëè, ph√°t huy v√† c·ªë g·∫Øng l√™n nh√© {ten}! üòâ", "N·ªÅn t·∫£ng kh√° ·ªïn r·ªìi üëè, {ten} c·ªë g·∫Øng luy·ªán ƒë·ªÅ nhi·ªÅu h∆°n nha üî•", "S·∫Øp gi·ªèi r·ªìi üåü, c·ªë th√™m ch√∫t n·ªØa n√†o {ten} üö¥", "ƒêi·ªÉm n√†y cho th·∫•y {ten} ƒë√£ n·∫Øm ƒë∆∞·ª£c ki·∫øn th·ª©c c∆° b·∫£n üëç. Ti·∫øp t·ª•c c·ªë g·∫Øng nh√©! üåà", "Kh√° ·ªïn ƒë√≥ {ten} üòé, l·∫ßn sau m·ª•c ti√™u 8+ nh√©! üí™", "{ten} √†, Steve Jobs th·ªùi c·∫•p ba c≈©ng ch·ªâ ·ªü m·ª©c n√†y üôå, r·ªìi t·∫°o ra üçé Apple thay ƒë·ªïi th·∫ø gi·ªõi! C·ªë l√™n nh√©!Ô∏è", "{ten} ∆°i, J.K. Rowling t·ª´ng b·ªã t·ª´ ch·ªëi nhi·ªÅu l·∫ßn üòä, nh∆∞ng v·∫´n vi·∫øt n√™n üìö Harry Potter b√°n h√†ng t·ª∑ cu·ªën! C·ªë l√™n nh√©!Ô∏è"],
                lv4: ["K·∫øt qu·∫£ ·ªïn ƒë√≥ üëè, ch√∫c m·ª´ng {ten} v√¨ s·ª± ti·∫øn b·ªô n√†y! üéâ", "R·∫•t ƒë√°ng khen üëè, {ten} gi·ªØ v·ªØng phong ƒë·ªô nh√© üòâ", "ƒêi·ªÉm s·ªë ƒë·∫πp üåü, ch√∫c m·ª´ng {ten}! Ti·∫øp t·ª•c ph√°t huy nh√©! üöÄ", "{ten} ∆°i, ch·ªâ c·∫ßn c·∫©n th·∫≠n ch√∫t x√≠u n·ªØa l√† ch·∫°m m·ªëc cao h∆°n r·ªìi! üî•", "{ten} ƒëang h·ªçc r·∫•t hi·ªáu qu·∫£ üî•, c·ªë g·∫Øng gi·ªØ nh·ªãp n√†y nha! üòé", "Gi·ªëng Albert Einstein th·ªùi trung h·ªçc l·∫Øm {ten} √† üëì, √¥ng ·∫•y h·ªçc kh√° th√¥i nh∆∞ng th√†nh huy·ªÅn tho·∫°i r·ªìi! C·ªë l√™n nh√©!Ô∏è", "{ten} ∆°i, ƒëi·ªÉm cao gi·ªëng Leonardo da Vinci th·ªùi tr·∫ª lu√¥n √° üé® C·ªë l√™n nh√©!Ô∏è"],
                lv5: ["M·ªôt b√†i l√†m ch·∫•t l∆∞·ª£ng cao üåü, ti·∫øp t·ª•c gi·ªØ phong ƒë·ªô nh√© {ten}! üöÄ", "Ki·∫øn th·ª©c c·ªßa {ten} kh√° v·ªØng r·ªìi üåà, ch√∫c m·ª´ng em! üëè", "Ch·ªâ thi·∫øu ch√∫t x√≠u n·ªØa l√† ƒëi·ªÉm tuy·ªát ƒë·ªëi r·ªìi {ten} ∆°i ü§©", "Tuy·ªát v·ªùi √¥ng m·∫∑t tr·ªùi! üåû Ch√∫c m·ª´ng {ten}! üëè", "Phong ƒë·ªô ƒë·ªânh ch√≥p üëç, ti·∫øp t·ª•c th·∫ø n√†y nh√© {ten}! üåü", "ƒêi·ªÉm ƒë·∫πp nh∆∞ th·ªùi Stephen Hawking h·ªçc ƒë·∫°i h·ªçc {ten} ∆°i üå†, √¥ng ·∫•y gi·ªèi v√† truy·ªÅn c·∫£m h·ª©ng cho c·∫£ th·∫ø gi·ªõi!", "{ten} √†, Marie Curie c≈©ng ·ªü m·ª©c n√†y tr∆∞·ªõc khi ƒëo·∫°t Nobel üôÜ‚ÄçÔ∏è, ti·∫øp t·ª•c ph√°t huy nh√©! üèÜ"],
                lv6: ["ƒê·ªàNH CH√ìP! üíØ {ten} l√† ni·ªÅm t·ª± h√†o c·ªßa c·∫£ l·ªõp! üòç", "Qu√° x·ªãn r·ªìi {ten} üéâ, ƒë√∫ng chu·∫©n h·ªçc sinh g∆∞∆°ng m·∫´u! üëç", "ƒê·ªânh c·ªßa ch√≥p! üëç Ch√∫c m·ª´ng {ten} nh√© üéâ", "K·∫øt qu·∫£ r·∫•t ·∫•n t∆∞·ª£ng ü§©, 10 ƒëi·ªÉm tr√≤n tr·ªãa cho s·ª± n·ªó l·ª±c c·ªßa {ten} üéâ", "Tuy·ªát v·ªùi √¥ng m·∫∑t tr·ªùi! üåû Ch√∫c m·ª´ng {ten}! üéâ", "ƒêi·ªÉm cao ƒë√∫ng chu·∫©n ‚ÄúElon Musk th·ªùi ƒëi h·ªçc‚Äù lu√¥n üöÄ, h√£y ti·∫øp t·ª•c chinh ph·ª•c v≈© tr·ª• ki·∫øn th·ª©c {ten} nh√©! üåå", "M·ª©c ƒëi·ªÉm n√†y nh∆∞ c·ªßa Bill Gates s√°ng l·∫≠p Microsoft {ten} ∆°i üí∞, ti·∫øp t·ª•c ph√°t huy nh√©! ‚ú®"]
            };

            // Ch·ªçn nh√≥m l·ªùi nh·∫Øn
            let selectedArr = [];
            if (diem < 4) { selectedArr = msgList.lv1; msgClass = "fb-low"; }
            else if (diem < 6) { selectedArr = msgList.lv2; msgClass = "fb-mid"; }
            else if (diem < 7) { selectedArr = msgList.lv3; msgClass = "fb-mid"; }
            else if (diem < 8) { selectedArr = msgList.lv4; msgClass = "fb-high"; }
            else if (diem <= 9) { selectedArr = msgList.lv5; msgClass = "fb-high"; } // S·ª≠a 8-9 bao g·ªìm c·∫£ 9
            else { selectedArr = msgList.lv6; msgClass = "fb-high"; }

            // Random l·ªùi nh·∫Øn v√† thay t√™n
            let randomMsg = selectedArr[Math.floor(Math.random() * selectedArr.length)];
            msg = randomMsg.replace("{ten}", ten);

            // Ch√®n v√†o giao di·ªán (Th√™m th·∫ª div feedback n·∫øu ch∆∞a c√≥)
            let resultContainer = document.getElementById('result-interface');
            let feedbackDiv = document.getElementById('feedback-msg');
            if (!feedbackDiv) {
                feedbackDiv = document.createElement('div');
                feedbackDiv.id = 'feedback-msg';
                // Ch√®n ngay d∆∞·ªõi ƒëi·ªÉm s·ªë (score-display n·∫±m trong h2)
                resultContainer.insertBefore(feedbackDiv, document.getElementById('result-details'));
            }
            feedbackDiv.className = `feedback-msg ${msgClass}`;
            feedbackDiv.innerHTML = `<strong>L·ªùi Th·∫ßy nh·∫Øn:</strong><br>"${msg}"`;

            // --- PH·∫¶N M·ªöI: HI·ªÇN TH·ªä MEME VUI ---
            // Kho meme (URL tr·ª±c ti·∫øp, load nhanh, t√¥i ch·ªçn meme vui, t√≠ch c·ª±c, ph√π h·ª£p h·ªçc sinh)
            const memeList = {
                low: [ // D∆∞·ªõi 6 ƒëi·ªÉm (lv1 + lv2)
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUya3V4NDA5bjJmNjIwaDlla2J0bTM2b3VteWoxYnA2eTdoZDEweDdvZiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/yoJC2K6rCzwNY2EngA/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUycWZuZTdnaWJjYXl1a3I4a2N6YnppanYyY25ucW91Y2Y1bDl3M3A4bSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/h99SOT2cABIUE/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUycDdtZnN6eDI4bWpyanU5MjIxNWh2enNwaXdzaHAzZG1iaW9qa2d4NyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/2uh5yKKmZjDFUy2DOM/giphy.gif",
                   "https://media0.giphy.com/media/v1.Y2lkPTZjMDliOTUyNDdxZnhiamQ1Mm9ycmFuMmNnMG5pZ2xnbHlpemU5NDlmeTl2bm10aiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/tBWTS5iya1Nkh1uiB9/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyZ2diOW9rOGtyODFlaXdueDI0N2E5dnU1YzkzczJjcGdydnViNGoxcyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/jJ2zMk9eXoht2VFxEV/giphy.gif",
				   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyZ2kzcTU1OWVvdTNibmVkbzcyOHpybWI1Y2pzcHJqdzBxenphOW1vYyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/1hXY6iNdTFpTW4je85/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyempoMDdxNzVhOW9wZjBjNXpqbTY4NTc4eXoweThyYWwzdmd1cmRrZCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/6XX4V0O8a0xdS/giphy.gif",
				   "https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExM2Z5MTFyZHVwOXFubGM5c2N6bjdoYng4cjd3YnAzcGY2Yzg5bnVvbSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/NgTGoJN7UejpeA8Zby/giphy.gif",
				   "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUyOHl3b251ZmtuODBnNWJqajQ5anNoOGNmbHhreTFrajZpYTNzM3BqcyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3o6nUQzWnaMz1cDrmo/giphy.gif"
                ],
                lv3: [ // 6-7 ƒëi·ªÉm: kh√° t·ªët, c·ªë th√™m ch√∫t
                   "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUyanhxbzBja3Zjb3V3em9mM3NzdjhobWFoYnV0MXJlejl4OGpkanc2eSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/IQHTtgvQyHuEi5Epkq/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUya3V4NDA5bjJmNjIwaDlla2J0bTM2b3VteWoxYnA2eTdoZDEweDdvZiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/yoJC2K6rCzwNY2EngA/giphy.gif",
                   "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUyOHl3b251ZmtuODBnNWJqajQ5anNoOGNmbHhreTFrajZpYTNzM3BqcyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3o6nUQzWnaMz1cDrmo/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyMm9uYmVwdmMwbTQyZmNud3EyYmpnNTZ3MnJjdG4yb2RjcXBmZGF1byZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Xq3vAx5aX0gaifRAsk/giphy.gif",
                   "https://media0.giphy.com/media/v1.Y2lkPTZjMDliOTUyNDdxZnhiamQ1Mm9ycmFuMmNnMG5pZ2xnbHlpemU5NDlmeTl2bm10aiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/tBWTS5iya1Nkh1uiB9/giphy.gif",
				   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyZ2kzcTU1OWVvdTNibmVkbzcyOHpybWI1Y2pzcHJqdzBxenphOW1vYyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/1hXY6iNdTFpTW4je85/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyempoMDdxNzVhOW9wZjBjNXpqbTY4NTc4eXoweThyYWwzdmd1cmRrZCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/6XX4V0O8a0xdS/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyMmkzczBldDl4ZXFrcXo3cWM0aHdkdzV4eWlid204cmxuazNjdHgxZSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xUA7b1otxlfgvqZGJq/giphy.gif",
				   "https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExM2Z5MTFyZHVwOXFubGM5c2N6bjdoYng4cjd3YnAzcGY2Yzg5bnVvbSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/NgTGoJN7UejpeA8Zby/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyZ2diOW9rOGtyODFlaXdueDI0N2E5dnU1YzkzczJjcGdydnViNGoxcyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/jJ2zMk9eXoht2VFxEV/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyOTdsZXF1c291eW1qczF6OW9nbGxteXEzbXExejcyNnJjN3plZzFkeSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/FemTGpEZeK27M5fKL4/giphy.gif",
                   "https://media1.giphy.com/media/v1.Y2lkPTZjMDliOTUyMThpZjIydHprZTAwZ3J2NXJ3YWZ3MGdka3ZuMDdmemlqNTkzOTdkayZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xUn3C8WqEzUEeQoRa0/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUycDdtZnN6eDI4bWpyanU5MjIxNWh2enNwaXdzaHAzZG1iaW9qa2d4NyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/2uh5yKKmZjDFUy2DOM/giphy.gif"
                ],
                lv4: [ // 7-8 ƒëi·ªÉm: r·∫•t t·ªët, success!
                   "https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExdXE3cWF6Mm91dTRnaHRwa3RlZ2Jwa3czcms1YTdsYjBxOWpvc3M2eSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/tIeCLkB8geYtW/giphy.gif",  // Cuu like
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyMm9uYmVwdmMwbTQyZmNud3EyYmpnNTZ3MnJjdG4yb2RjcXBmZGF1byZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Xq3vAx5aX0gaifRAsk/giphy.gif",
                   "https://media0.giphy.com/media/v1.Y2lkPTZjMDliOTUycG85c3ZveDQxbHhqeHNicTBkaXI1aGV1azY4Y3lmemppZ2V4YmZ2eSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/gnNxCUUzGiKuYnLxJN/giphy.gif",
                   "https://media0.giphy.com/media/v1.Y2lkPTZjMDliOTUyNDdxZnhiamQ1Mm9ycmFuMmNnMG5pZ2xnbHlpemU5NDlmeTl2bm10aiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/tBWTS5iya1Nkh1uiB9/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyOTdsZXF1c291eW1qczF6OW9nbGxteXEzbXExejcyNnJjN3plZzFkeSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/FemTGpEZeK27M5fKL4/giphy.gif",
                   "https://media1.giphy.com/media/v1.Y2lkPTZjMDliOTUyMThpZjIydHprZTAwZ3J2NXJ3YWZ3MGdka3ZuMDdmemlqNTkzOTdkayZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xUn3C8WqEzUEeQoRa0/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyaXpyYnkxbWxqZnp3ajJ2Z2M0N25uMDZiZWJwNWt2cGpsNGJyNG5uayZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/9H279yb0blggo/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyMjBxb2pvcHhqdHE0bHN5dzJxbm83Nnljcm05cTF2OWc1b3E1cWM1NSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/x0yxQpWV9gPMRHnw7u/giphy.gif",
                   "https://media0.giphy.com/media/v1.Y2lkPTZjMDliOTUybzV1MHB2Nm5uY2c5bXExc3N6MWZiaGRzb28weXo1a3F0eHoya2NweCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/YJ09hqJCLme4g/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUycHhtZjdzbWFzZDB2NXZ4MXY3azhycHdoZmkzeGhmNnRxempmOGI3dSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/wvrn7MMemcOB2/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyY2c3ZWVmNzY3amFmenJrNGg4NGoycTkwcHUzb3A0dmxjZGxhbnEzMiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/PhR99fbNjhAAzopGnm/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExOXV0c3VwendhMmJ5ajZpcDV0MHY5ZWUyYW5qMHM0a3V3N2w4cm1rMSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/tnMUXTkYUWKe1dasNJ/giphy.gif"
                ],
                lv5: [ // 8-9 ƒëi·ªÉm: gi·ªèi l·∫Øm, smart!
                   "https://media0.giphy.com/media/v1.Y2lkPTZjMDliOTUycG85c3ZveDQxbHhqeHNicTBkaXI1aGV1azY4Y3lmemppZ2V4YmZ2eSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/gnNxCUUzGiKuYnLxJN/giphy.gif",
                   "https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExN2t3MjAxODMwMTFoYnZoN3MyamlyNHFocTVvM2lzMDMxNjhxbGtsciZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3NtY188QaxDdC/giphy.gif",
                   "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUyancxNHF6ZnpkdWZlajdjYTh2d2xiczk2cXR4NTV3NnV3YnJzeHpuYyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Swx36wwSsU49HAnIhC/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyNGF2djhjdGFsZmllYzFpYWFsZnc2NHEweTk2dTFtNTl1ZTY4bzlndSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/50YgxbPnjA1LG/giphy.gif",
                   "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUyNnVvZncxZ2hocmExZnRjbDc5YTB4aDk4b2tlZGpnYTVtem84aTgxOSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/s54cTulj6JbU0GOGg4/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyZWNocjdjbWp4bmRlaXczNGE3ZXNmNTdrdXh3MzJxYzhpbGppN25keiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Only6nbYqnhVcIaHO7/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyZWNocDNidG4wZGt3N201Y25rbHVyazNmbm9tNHNsdW4zNnBjeXlndSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/AlQwFJLmBwVrJ2DFn3/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyY2c3ZWVmNzY3amFmenJrNGg4NGoycTkwcHUzb3A0dmxjZGxhbnEzMiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/PhR99fbNjhAAzopGnm/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyeTNiMnNpejlkOG9qNzV0Z3Q2azZ0bjdiZjIzbG9naDdpd3dqeW1xYiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Q66ZEIpjEQddUOOKGW/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyb28xOGprZmJxeG5rYjV2dzV5bGVpZTEyZ2VlMzVkMnYyeXM1N3VrbyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3o7absbD7PbTFQa0c8/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUydDFpMm1oanluNjJmcm1pb2pydzg2OWRvYzh2NnZ6ZXdsaTF4anFvNiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/t3sZxY5zS5B0z5zMIz/giphy.gif",
                   "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUybnc5NWwxYTNzc2Y4bnNrbm8xanp4MDdwZm1sY3BnMDB2NmF5NTc5ayZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/BWD3CtcudWL28/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyMmkzczBldDl4ZXFrcXo3cWM0aHdkdzV4eWlid204cmxuazNjdHgxZSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xUA7b1otxlfgvqZGJq/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyaW4xZTRoMnB1aTdxYWhuamhnbW1taGF1NGVpdWIybG5yM2JldXEzbSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/AWTJeBx5MiEoEqDFIr/giphy.gif",
                   "https://media0.giphy.com/media/v1.Y2lkPTZjMDliOTUybzV1MHB2Nm5uY2c5bXExc3N6MWZiaGRzb28weXo1a3F0eHoya2NweCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/YJ09hqJCLme4g/giphy.gif",
				   "https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExdXE3cWF6Mm91dTRnaHRwa3RlZ2Jwa3czcms1YTdsYjBxOWpvc3M2eSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/tIeCLkB8geYtW/giphy.gif",
				   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyZzA3eW4zam9nMDNnOHo2cDNxOWtwcno5MXlhemZjanljNDZjd2dlcSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/hflpSaYuR8xK8/giphy.gif",
                   "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUyMnk4NnAwc2JnZGNkd3F4NmV0eDIyYTYwZWY4eXdzb3NwMzVtMnl5aiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xUjSOWCndCdECCyOEY/giphy.gif",
                   "https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExbnE2c2x5OGpoam5wMHMzbGh0bHNuZTY1eHc2ajVqZTIzOXhsNnEzeiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/qAmdxxyQ4XTt3KGt3c/giphy.gif"
                ],
                lv6: [ // Tr√™n 9 ƒëi·ªÉm: ƒë·ªânh ch√≥p, epic win!
                   "https://media0.giphy.com/media/v1.Y2lkPTZjMDliOTUycG85c3ZveDQxbHhqeHNicTBkaXI1aGV1azY4Y3lmemppZ2V4YmZ2eSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/gnNxCUUzGiKuYnLxJN/giphy.gif",
                   "https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExN2t3MjAxODMwMTFoYnZoN3MyamlyNHFocTVvM2lzMDMxNjhxbGtsciZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3NtY188QaxDdC/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyNGF2djhjdGFsZmllYzFpYWFsZnc2NHEweTk2dTFtNTl1ZTY4bzlndSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/50YgxbPnjA1LG/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyaWwzcTJoNWM0MHJrc2hobWN4ZHlpbW5pNjJkcGh1b3dkMTdpeWNmMyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/nbvFVPiEiJH6JOGIok/giphy.gif",
                   "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUyMnk4NnAwc2JnZGNkd3F4NmV0eDIyYTYwZWY4eXdzb3NwMzVtMnl5aiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xUjSOWCndCdECCyOEY/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyc2IyNnBuMms2OXlwMTZuejY2YjY0b2ZqM2lwM3Ixc2p6eGxueGYxdiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/cdXpgeB32BekIGzBNh/giphy.gif",
                   "https://media1.giphy.com/media/v1.Y2lkPTZjMDliOTUyMmwzcHY3am03eGRlaTQzbXNua2drbTdpZmVtaDFyODBjejlmeWZ0eiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/bb1PFnM9zHnR3Ns3tG/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExOXV0c3VwendhMmJ5ajZpcDV0MHY5ZWUyYW5qMHM0a3V3N2w4cm1rMSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/tnMUXTkYUWKe1dasNJ/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyb28xOGprZmJxeG5rYjV2dzV5bGVpZTEyZ2VlMzVkMnYyeXM1N3VrbyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3o7absbD7PbTFQa0c8/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyeTNiMnNpejlkOG9qNzV0Z3Q2azZ0bjdiZjIzbG9naDdpd3dqeW1xYiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Q66ZEIpjEQddUOOKGW/giphy.gif",
				   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyZzA3eW4zam9nMDNnOHo2cDNxOWtwcno5MXlhemZjanljNDZjd2dlcSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/hflpSaYuR8xK8/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUyMjBxb2pvcHhqdHE0bHN5dzJxbm83Nnljcm05cTF2OWc1b3E1cWM1NSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/x0yxQpWV9gPMRHnw7u/giphy.gif",
                   "https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUyaW4xZTRoMnB1aTdxYWhuamhnbW1taGF1NGVpdWIybG5yM2JldXEzbSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/AWTJeBx5MiEoEqDFIr/giphy.gif",
                   "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUybnc5NWwxYTNzc2Y4bnNrbm8xanp4MDdwZm1sY3BnMDB2NmF5NTc5ayZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/BWD3CtcudWL28/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTZjMDliOTUydDFpMm1oanluNjJmcm1pb2pydzg2OWRvYzh2NnZ6ZXdsaTF4anFvNiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/t3sZxY5zS5B0z5zMIz/giphy.gif",
                   "https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExdzVvOHVoc3FocHlrcGppdTJpcGxpZ3Q3ZjFkdm5ycXU5Y2dpdDI2MiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/KhdCldraGlzwqTc4Vb/giphy.gif",
                   "https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExOHpzNXp2ZjIxZzliOWNrOXpkdHR2NzZoNHZwOGQ0Y3I5eG13OXBrcCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/r1d69SdEpcxmhzlHd1/giphy.gif"
                ]
            };

            // X√°c ƒë·ªãnh level meme
            let selectedMemeArr = [];
            if (diem < 6) {
                selectedMemeArr = memeList.low;
            } else if (diem < 7) {
                selectedMemeArr = memeList.lv3;
            } else if (diem < 8) {
                selectedMemeArr = memeList.lv4;
            } else if (diem <= 9) {
                selectedMemeArr = memeList.lv5;
            } else {
                selectedMemeArr = memeList.lv6;
            }

           // Lu√¥n hi·ªÉn th·ªã n√∫t n·∫øu c√≥ meme (t·∫•t c·∫£ level ƒë·ªÅu c√≥)
            let memeContainer = document.getElementById('meme-container');
            if (!memeContainer) {
                memeContainer = document.createElement('div');
                memeContainer.id = 'meme-container';
                memeContainer.style.display = 'none';  // ·∫®n ban ƒë·∫ßu
                memeContainer.style.marginTop = '20px';
                memeContainer.style.textAlign = 'center';  // CƒÉn gi·ªØa meme
                feedbackDiv.insertAdjacentElement('afterend', memeContainer);
            }

            // ƒê·∫£m b·∫£o khu v·ª±c n√∫t c≈©ng center (th√™m text-align center cho feedbackDiv n·∫øu ch∆∞a c√≥)
            feedbackDiv.style.textAlign = 'center';  // Th√™m d√≤ng n√†y ƒë·ªÉ n√∫t v√† text center

            let memeButton = document.getElementById('meme-button');
            if (!memeButton) {
                memeButton = document.createElement('button');
                memeButton.id = 'meme-button';
                memeButton.textContent = 'üëâüéÅüòâ';

                // Style cho n√∫t - quay l·∫°i k√≠ch th∆∞·ªõc b·∫°n mu·ªën
                memeButton.style.marginTop = '15px';
                memeButton.style.padding = '8px 12px';     // Nh∆∞ b·∫°n y√™u c·∫ßu
                memeButton.style.fontSize = '18px';         // Ch·ªØ 16px
                memeButton.style.background = '#bef7f5';    // M√†u n·ªÅn xanh ng·ªçc
                memeButton.style.color = '#333333';         // M√†u ch·ªØ
                memeButton.style.border = 'none';
                memeButton.style.borderRadius = '12px';
                memeButton.style.cursor = 'pointer';
                memeButton.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
                
                // QUAN TR·ªåNG: C√°c style ƒë·ªÉ cƒÉn gi·ªØa ho√†n h·∫£o
                memeButton.style.display = 'block';         // ƒê·ªïi th√†nh block ƒë·ªÉ margin auto ho·∫°t ƒë·ªông
                memeButton.style.marginLeft = 'auto';       // CƒÉn gi·ªØa ngang
                memeButton.style.marginRight = 'auto';      // CƒÉn gi·ªØa ngang

                feedbackDiv.insertAdjacentElement('afterend', memeButton);

                memeButton.addEventListener('click', function() {
                    const randomMeme = selectedMemeArr[Math.floor(Math.random() * selectedMemeArr.length)];
                    memeContainer.innerHTML = `<img src="${randomMeme}" alt="Meme vui" loading="lazy" class="meme-img">`;
                    memeContainer.style.display = 'block';
                    memeButton.style.display = 'none';

                    setTimeout(() => {
                        const img = memeContainer.querySelector('img');
                        if (img) img.style.opacity = '1';
                    }, 100);
                });
            }
			
			// HI·ªÜU ·ª®NG PH√ÅO HOA (N·∫øu ƒëi·ªÉm >= 8)
            if (diem >= 8) {
                var duration = 3 * 1000;
                var animationEnd = Date.now() + duration;
                var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

                var interval = setInterval(function() {
                    var timeLeft = animationEnd - Date.now();
                    if (timeLeft <= 0) { return clearInterval(interval); }
                    var particleCount = 50 * (timeLeft / duration);
                    confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                    confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
                }, 250);
            }
            // H√†m ph·ª• tr·ª£ cho ph√°o hoa
            function randomInRange(min, max) { return Math.random() * (max - min) + min; }
            
            // ----------------------------------------------

            // Render chi ti·∫øt (Gi·ªØ nguy√™n ph·∫ßn c≈©)
            let html = '';
            // ... (Ph·∫ßn hi·ªÉn th·ªã chi ti·∫øt c√¢u h·ªèi gi·ªØ nguy√™n nh∆∞ c≈©)
            res.chiTiet.forEach((item, idx) => {
                let userChoice = baiLam[idx];
                let isCorrect = (item.diem > 0); 
                let color = isCorrect ? 'green' : 'red';
                let style = `border-bottom:1px solid #eee; padding:15px; background: ${isCorrect ? '#f0fff4' : '#fff5f5'}`;
                
                html += `<div style="${style}"><strong>C√¢u ${item.cau}:</strong> <span style="color:${color}; font-weight:bold">+${item.diem}</span>`;
                
                if (Array.isArray(item.ketQua)) { 
                     let visual = item.ketQua.map(k => k ? '‚úÖ' : '‚ùå').join(' ');
                     let userText = userChoice.map(u => u===true?'ƒê':(u===false?'S':'_')).join('-');
                     html += `<br>K·∫øt qu·∫£: ${visual} (Ch·ªçn: ${userText})`;
                } else {
                    html += `<br>K·∫øt qu·∫£: ${item.ketQua === 'ƒê√∫ng' ? 'ƒê√∫ng' : 'Sai'} (B·∫°n ch·ªçn: <b>${userChoice || 'Tr·ªëng'}</b>)`;
                }
                html += `</div>`;
            });
            document.getElementById('result-details').innerHTML = html;
			window.scrollTo(0, 0);

        } catch(e) { 
            alert("L·ªói n·ªôp b√†i! Vui l√≤ng ki·ªÉm tra m·∫°ng."); 
            console.error(e);
            // M·ªü l·∫°i n√∫t n·∫øu l·ªói m·∫°ng
            btnSubmit.disabled = false;
            btnSubmit.innerHTML = originalText;
        }
    }

    // --- GI√ÅO VI√äN ---
    function showLoginAdmin() { hideAll(); document.getElementById('login-admin').style.display = 'block'; }

    async function loginAdmin() {
        const pass = document.getElementById('admin-pass').value;
        showLoader(true);
        const formData = new FormData();
        formData.append('action', 'admin_login');
        formData.append('pass', pass);
        const res = await fetch(API_URL, { method: 'POST', body: formData }).then(r => r.json());
        showLoader(false);
        if(res.status === 'ok') { hideAll(); document.getElementById('admin-panel').style.display = 'block'; } 
        else { alert(res.msg); }
    }

    async function luuDeThi(event) {
    // 1. L·∫§Y ƒê·ªêI T∆Ø·ª¢NG N√öT V√Ä L∆ØU TR·∫†NG TH√ÅI C≈®
    const btn = event.target; 
    const originalText = btn.innerHTML;

    // 2. THU TH·∫¨P D·ªÆ LI·ªÜU (Gi·ªØ nguy√™n logic c·ªßa b·∫°n)
    const ma = document.getElementById('new-exam-code').value.trim();
    const ten = document.getElementById('new-exam-name').value.trim();
    const cfg = {
        p1_num: parseInt(document.getElementById('cfg-p1-num').value) || 0,
        p1_score: parseFloat(document.getElementById('cfg-p1-score').value) || 0,
        p2_num: parseInt(document.getElementById('cfg-p2-num').value) || 0,
        p2_mode: document.getElementById('cfg-p2-mode').value,
        p3_num: parseInt(document.getElementById('cfg-p3-num').value) || 0,
        p3_score: parseFloat(document.getElementById('cfg-p3-score').value) || 0
    };
    const raw = document.getElementById('exam-data-input').value;

    // Ki·ªÉm tra ƒë·∫ßu v√†o
    if(!ma || !ten || !raw) return alert("Vui l√≤ng nh·∫≠p ƒë·ªß th√¥ng tin!");

    // X·ª≠ l√Ω t√°ch d√≤ng ƒë√°p √°n
    let lines = raw.split('\n').filter(l => l.trim() !== "");
    let dapAn = [];
    let totalQ = cfg.p1_num + cfg.p2_num + cfg.p3_num;
    let currentLine = 0;
    
    function parseLine(line) { 
        let dot = line.indexOf('.'); 
        return dot === -1 ? line.trim() : line.substring(dot+1).trim(); 
    }

    for(let i=0; i<cfg.p1_num; i++) {
        if(currentLine >= lines.length) break;
        dapAn.push({id: i+1, dang: 1, dapAn: parseLine(lines[currentLine++]).toUpperCase()});
    }
    for(let i=0; i<cfg.p2_num; i++) {
        if(currentLine >= lines.length) break;
        let arr = parseLine(lines[currentLine++]).split('').map(c => c.toUpperCase() === 'ƒê');
        dapAn.push({id: dapAn.length+1, dang: 2, dapAn: arr, soY: 4});
    }
    for(let i=0; i<cfg.p3_num; i++) {
        if(currentLine >= lines.length) break;
        dapAn.push({id: dapAn.length+1, dang: 3, dapAn: parseFloat(parseLine(lines[currentLine++]).replace(',', '.'))});
    }

    if (dapAn.length !== totalQ) {
        if(!confirm(`C·∫•u h√¨nh ${totalQ} c√¢u nh∆∞ng ƒë·ªçc ƒë∆∞·ª£c ${dapAn.length} d√≤ng. L∆∞u kh√¥ng?`)) return;
    }

    // 3. B·∫ÆT ƒê·∫¶U QU√Å TR√åNH G·ª¨I D·ªÆ LI·ªÜU
    const payload = { maDe: ma, tenDe: ten, dapAn: dapAn, config: cfg };
    const formData = new FormData();
    formData.append('action', 'save_exam');
    formData.append('data', JSON.stringify(payload));

    // ƒê·ªîI GIAO DI·ªÜN N√öT TH√ÄNH LOADING (Thay cho showLoader h·ªá th·ªëng)
    btn.disabled = true;
    btn.innerHTML = '<div class="btn-loader"></div> ƒêang l∆∞u...';

    try {
        const response = await fetch(API_URL, { method: 'POST', body: formData });
        const result = await response.json(); // Gi·∫£ s·ª≠ API tr·∫£ v·ªÅ JSON

        if(result.status === 'success' || response.ok) {
            alert("L∆∞u th√†nh c√¥ng! B·∫°n c√≥ th·ªÉ t·∫Øt trang ho·∫∑c t·∫°o ƒë·ªÅ kh√°c.!");
        } else {
            alert("C√≥ l·ªói x·∫£y ra: " + (result.msg || "Kh√¥ng x√°c ƒë·ªãnh"));
        }
    } catch(e) {
        console.error(e);
        alert("L·ªói k·∫øt n·ªëi m·∫°ng ho·∫∑c m√°y ch·ªß!");
    } finally {
        // 4. TR·∫¢ L·∫†I N√öT TR·∫†NG TH√ÅI BAN ƒê·∫¶U (D√π th√†nh c√¥ng hay th·∫•t b·∫°i)
        btn.disabled = false;
        btn.innerHTML = originalText;
    }
}

// --- C·∫§U H√åNH S·ª¨A SAI ---
    const MAX_LAN_THU = 2; // Th·∫ßy ƒë·ªïi s·ªë n√†y n·∫øu mu·ªën tƒÉng/gi·∫£m s·ªë l∆∞·ª£t
    let soLanDaThu = 0;    // Bi·∫øn ƒë·∫øm s·ªë l·∫ßn ƒë√£ b·∫•m

    function cheDoSuaSai() {
        // 1. Chuy·ªÉn ƒë·ªïi giao di·ªán
        document.getElementById('result-interface').style.display = 'none';
        document.getElementById('exam-interface').style.display = 'block';
        document.getElementById('questions-container').style.display = 'block';

        // 2. TH√äM ƒêO·∫†N TIN NH·∫ÆN ƒê·ªòNG VI√äN (Y√™u c·∫ßu 1)
        // Ki·ªÉm tra n·∫øu ch∆∞a c√≥ th√¨ m·ªõi t·∫°o, tr√°nh t·∫°o tr√πng l·∫∑p
        if (!document.getElementById('msg-dong-vien')) {
            const msgDiv = document.createElement('div');
            msgDiv.id = 'msg-dong-vien';
            msgDiv.style.cssText = `
                background-color: #e8f5e9; 
                border: 1px solid #4caf50; 
                color: #2e7d32;
                padding: 15px; 
                margin: 15px auto; 
                border-radius: 8px; 
                text-align: center; 
                max-width: 90%;
                font-family: Arial, sans-serif;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            `;
            
            msgDiv.innerHTML = `
                <div style="font-size: 0.98em; margin-bottom: 8px;">
                    M·ªói c√¢u tr·∫£ l·ªùi ch∆∞a ƒë√∫ng l√† m·ªôt c∆° h·ªôi ƒë·ªÉ em hi·ªÉu r√µ v·∫•n ƒë·ªÅ. 
                    ƒê·ª´ng s·ª£ sai, quan tr·ªçng l√† h·ªçc ƒë∆∞·ª£c g√¨ t·ª´ l·ªói sai ƒë√≥ ƒë·ªÉ v·ªØng v√†ng h∆°n.
                </div>
                <div style="font-size: 0.95em; color: #555;">
                    H√£y l√†m l·∫°i c√°c c√¢u ·ªü d∆∞·ªõi v√† nh·∫•n "Ki·ªÉm tra l·∫°i" - em c√≥ 2 l·∫ßn nh·∫•n. 
                    L∆∞u √Ω: ƒêi·ªÉm s·ªë ƒë√£ l∆∞u tr∆∞·ªõc ƒë√≥ kh√¥ng thay ƒë·ªïi.
                </div>
            `;

            // Ch√®n v√†o ngay d∆∞·ªõi Ti√™u ƒë·ªÅ ƒë·ªÅ thi (th·∫ª h2 ƒë·∫ßu ti√™n trong exam-interface)
            const header = document.querySelector('#exam-interface h2');
            header.parentNode.insertBefore(msgDiv, header.nextSibling);
        } else {
            // N·∫øu c√≥ r·ªìi th√¨ hi·ªán n√≥ l√™n (ph√≤ng tr∆∞·ªùng h·ª£p b·ªã ·∫©n)
            document.getElementById('msg-dong-vien').style.display = 'block';
        }

        // 3. Reset tr·∫°ng th√°i
        soLanDaThu = 0; 
        
        // 4. L·ªçc c√¢u sai ƒë·ªÉ hi·ªÉn th·ªã
        const questionDivs = document.querySelectorAll('.question-box');
        let countSai = 0;

        questionDivs.forEach((div, index) => {
            // Reset m√†u s·∫Øc c≈© (n·∫øu c√≥)
            div.style.border = "1px solid #ccc"; 
            div.style.backgroundColor = "#fff";

            let dataCau = window.ketQuaChiTiet[index];
            let isWrong = false;

            // Logic x√°c ƒë·ªãnh c√¢u sai
            if (Array.isArray(dataCau.ketQua)) {
                if (dataCau.ketQua.includes(false)) isWrong = true;
            } else {
                if (dataCau.diem == 0) isWrong = true;
            }

            if (isWrong) {
                div.style.display = 'block'; 
                div.style.borderLeft = '5px solid #f39c12'; // ƒê√°nh d·∫•u nh·∫π c√¢u c·∫ßn s·ª≠a
                countSai++;
            } else {
                div.style.display = 'none';
            }
        });

        // 5. C·∫≠p nh·∫≠t n√∫t b·∫•m
        const btnSubmit = document.querySelector('#exam-interface .btn');
        // Thay th·∫ø n√∫t c≈© b·∫±ng n√∫t m·ªõi ƒë·ªÉ x√≥a s·∫°ch c√°c s·ª± ki·ªán c≈©
        let newBtn = btnSubmit.cloneNode(true);
        btnSubmit.parentNode.replaceChild(newBtn, btnSubmit);
        
        newBtn.id = "btn-check-again"; // ƒê·∫∑t ID ƒë·ªÉ d·ªÖ g·ªçi
        newBtn.innerHTML = `KI·ªÇM TRA L·∫†I (C√≤n ${MAX_LAN_THU} l∆∞·ª£t)`;
        newBtn.style.background = "#f39c12"; 
        newBtn.disabled = false;
        newBtn.onclick = chamDiemTaiCho; 

        window.scrollTo(0, 0);
    }

    function chamDiemTaiCho() {
        const btn = document.getElementById('btn-check-again');
        
        // --- LOGIC GI·ªöI H·∫†N S·ªê L·∫¶N (Y√™u c·∫ßu 2) ---
        soLanDaThu++;
        let conLai = MAX_LAN_THU - soLanDaThu;

        let countDung = 0;
        let totalSai = 0;
        
        const questionDivs = document.querySelectorAll('.question-box');

        // Logic ch·∫•m ƒëi·ªÉm (gi·ªØ nguy√™n logic c≈©)
        window.ketQuaChiTiet.forEach((dataCau, i) => {
            const div = questionDivs[i];
            if (div.style.display === 'none') return; 

            totalSai++;
            let isCorrectNow = false;
            let dapAnDung = dataCau.dapAn;
            let userVal;
            
            // D·∫°ng 1: Tr·∫Øc nghi·ªám
            if (typeof dapAnDung === 'string' && dapAnDung.length === 1) {
                const el = document.querySelector(`input[name="c${i}"]:checked`);
                userVal = el ? el.value : "";
                if (userVal === dapAnDung) isCorrectNow = true;
            }
            // D·∫°ng 2: ƒê√∫ng Sai
            else if (Array.isArray(dapAnDung)) {
                let checkArr = [];
                for(let j=0; j<4; j++) {
                    const el = document.querySelector(`input[name="c${i}_${j}"]:checked`);
                    let val = el ? (el.value === 'true') : null;
                    checkArr.push(val === dapAnDung[j]);
                }
                if (!checkArr.includes(false)) isCorrectNow = true;
            }
            // D·∫°ng 3: ƒêi·ªÅn s·ªë
            else {
                let el = document.getElementById(`c${i}`);
                userVal = parseFloat(el.value.replace(',', '.'));
                let valDung = parseFloat(dapAnDung);
                if (!isNaN(userVal) && Math.abs(userVal - valDung) < 0.0001) isCorrectNow = true;
            }

            if (isCorrectNow) {
                div.style.border = "2px solid green";
                div.style.backgroundColor = "#f0fff4";
                countDung++;
            } else {
                div.style.border = "2px solid red";
                div.style.backgroundColor = "#fff5f5";
            }
        });

        // --- X·ª¨ L√ù K·∫æT QU·∫¢ SAU KHI CH·∫§M ---
        if (countDung === totalSai) {
            // Tr∆∞·ªùng h·ª£p 1: S·ª≠a ƒë√∫ng h·∫øt
            btn.innerHTML = "üéâ HO√ÄN TH√ÄNH XU·∫§T S·∫ÆC!";
            btn.style.background = "#28a745";
            btn.disabled = true;
            alert("TUY·ªÜT V·ªúI! Em ƒë√£ hi·ªÉu b√†i h∆°n r·ªìi ƒë·∫•y.");
            
            //setTimeout(() => {
            //    if(confirm("H√£y c·ªë g·∫Øng v√† c·∫©n th·∫≠n h∆°n ·ªü nh·ªØng b√†i sau nh√©!")) location.reload();
            //}, 1000);

        } else {
            // Tr∆∞·ªùng h·ª£p 2: V·∫´n c√≤n sai
            if (conLai > 0) {
                // V·∫´n c√≤n l∆∞·ª£t
                btn.innerHTML = `KI·ªÇM TRA L·∫†I (C√≤n ${conLai} l∆∞·ª£t)`;
                alert(`Em ƒë√£ s·ª≠a ƒë√∫ng ${countDung}/${totalSai} c√¢u.\nV·∫´n c√≤n c√¢u sai (vi·ªÅn ƒë·ªè), h√£y c·ªë g·∫Øng suy nghƒ© th√™m nh√©!`);
            } else {
                // H·∫øt l∆∞·ª£t
                btn.innerHTML = "ƒê√É H·∫æT L∆Ø·ª¢T KI·ªÇM TRA";
                btn.style.background = "#7f8c8d"; // M√†u x√°m
                btn.disabled = true;
                alert("R·∫•t ti·∫øc, em ƒë√£ h·∫øt l∆∞·ª£t ki·ªÉm tra l·∫°i.\nH√£y xem l·∫°i s√°ch v·ªü ho·∫∑c h·ªèi th·∫ßy c√¥ ƒë·ªÉ ƒë∆∞·ª£c gi·∫£i ƒë√°p nh√©!");
            }
        }
    }

let clickCount = 0;
let clickTimer;

function xuLyBamNut(event) {
    clickCount++;
    clearTimeout(clickTimer);
    
    clickTimer = setTimeout(() => {
        if (clickCount >= 23) {
            // M·ªëc cao nh·∫•t: 23 l·∫ßn tr·ªü l√™n
            document.getElementById('modal-sieu-bi-mat').style.display = 'flex';
        } 
        else if (clickCount >= 10) {
            // M·ªëc trung b√¨nh: t·ª´ 10 ƒë·∫øn 22 l·∫ßn
            document.getElementById('modal-bi-mat').style.display = 'flex';
        } 
        else if (clickCount === 1) {
            // M·ªëc th·∫•p nh·∫•t: ch·ªâ 1 l·∫ßn
            document.getElementById('modal-huong-dan').style.display = 'flex';
        }
        
        // Reset bi·∫øn ƒë·∫øm sau khi ƒë√£ m·ªü popup th√†nh c√¥ng
        clickCount = 0; 
    }, 300); // 0.3 gi√¢y ƒë·ªÉ ƒë·ª£i xem b·∫°n c√≥ b·∫•m ti·∫øp kh√¥ng
}

function moModal(id) {
    document.getElementById(id).style.display = 'flex';
}

function dongModal(id) {
    document.getElementById(id).style.display = 'none';
}


</script>

</body>
</html>

